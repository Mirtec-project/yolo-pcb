# Ultralytics ğŸš€ AGPL-3.0 License - https://ultralytics.com/license
# YOLOv10m-memory-lite-opt object detection model for PCB data (2 classes, further optimized for memory)
# Model docs: https://docs.ultralytics.com/models/yolov10
# Task docs: https://docs.ultralytics.com/tasks/detect

nc: 2  # number of classes

# ìŠ¤ì¼€ì¼ ê°’ì„ ë‚®ì¶° ì „ì²´ íŒŒë¼ë¯¸í„°ì™€ í™œì„±ê°’(activation) í¬ê¸°ë¥¼ ì¤„ì„
# [depth_scale, width_scale, max_channels]
scales:
  m: [0.5, 0.5, 512]  

# --- Further Simplified & Memory-Efficient Backbone ---
# ê¸°ì¡´ ëª¨ë¸ ëŒ€ë¹„ ê° Conv/C3k2 ëª¨ë“ˆì˜ ë°˜ë³µ íšŸìˆ˜ë¥¼ 1íšŒë¡œ ìœ ì§€í•˜ë©´ì„œ,
# ë” ì¤‘ìš”í•œ ì ì€ ê¹Šì€ ë ˆì´ì–´ì—ì„œì˜ ì±„ë„ ìˆ˜ë¥¼ ì¶”ê°€ë¡œ ë‚®ì¶° ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ì ˆê°í•œ ì ì…ë‹ˆë‹¤.
backbone:
  # [from, repeats, module, args]
  - [-1, 1, Conv, [32, 3, 2]]           # 0: P1/2; ì›ë˜ 64 ì±„ë„ â†’ 64Ã—0.5 = 32
  - [-1, 1, Conv, [64, 3, 2]]           # 1: P2/4; ì›ë˜ 128 ì±„ë„ â†’ 128Ã—0.5 = 64
  # layer 2: ì›ë˜ C3k2 ëª¨ë“ˆ 256 ì±„ë„ â†’ 256Ã—0.5 = 128, ì—¬ê¸°ì„œëŠ” ë©”ëª¨ë¦¬ ì ˆê°ì„ ìœ„í•´ 128 ëŒ€ì‹  96 ì±„ë„ ì‚¬ìš©
  - [-1, 1, C3k2, [96, False, 0.25]]    # 2: P2/4
  # layer 3: ì›ë˜ 256 ì±„ë„ â†’ 128 ì±„ë„ë¡œ ì¶•ì†Œ
  - [-1, 1, Conv, [96, 3, 2]]           # 3: P3/8
  # layer 4: ì›ë˜ C3k2 ëª¨ë“ˆ 512 ì±„ë„ â†’ 512Ã—0.5 = 256, ì—¬ê¸°ì„œëŠ” 256 ëŒ€ì‹  160 ì±„ë„ ì‚¬ìš©
  - [-1, 1, C3k2, [160, False, 0.25]]    # 4: P3/8
  # layer 5: ì›ë˜ 512 ì±„ë„ â†’ 256 ì±„ë„, ì—¬ê¸°ì„œëŠ” 160 ì±„ë„ ì‚¬ìš©
  - [-1, 1, Conv, [160, 3, 2]]          # 5: P4/16
  # layer 6: ì›ë˜ C3k2 ëª¨ë“ˆ 512 ì±„ë„ â†’ 256 ì±„ë„, ì—¬ê¸°ì„œëŠ” 160 ì±„ë„ ì‚¬ìš©
  - [-1, 1, C3k2, [160, True]]          # 6: P4/16
  # layer 7: ì›ë˜ 1024 ì±„ë„ â†’ 1024Ã—0.5 = 512, ì—¬ê¸°ì„œëŠ” 512 ëŒ€ì‹  320 ì±„ë„ ì‚¬ìš©
  - [-1, 1, Conv, [320, 3, 2]]          # 7: P5/32
  # layer 8: ì›ë˜ C3k2 ëª¨ë“ˆ 1024 ì±„ë„ â†’ 512 ì±„ë„, ì—¬ê¸°ì„œëŠ” 320 ì±„ë„ ì‚¬ìš©
  - [-1, 1, C3k2, [320, True]]          # 8: P5/32
  # layer 9: SPPF ëª¨ë“ˆë„ ì±„ë„ ìˆ˜ë¥¼ ì¤„ì—¬ 320 ì±„ë„ë¡œ ì ìš©
  - [-1, 1, SPPF, [320, 5]]             # 9: SPPF (spatial pyramid pooling)
  # C2PSA ëª¨ë“ˆì€ ë‹¨ìˆœ PCB ë°ì´í„°ì— ê³¼ë„í•œ ë³µì¡ë„ë¥¼ ì£¼ë¯€ë¡œ ì œê±°í•¨

# --- Further Simplified & Memory-Efficient Head ---
# ê²€ì¶œ í—¤ë“œë¥¼ ë‹¨ì¼ ìŠ¤ì¼€ì¼(ì£¼ë¡œ P3/P4)ë¡œ ë‹¨ìˆœí™”í•˜ì—¬ ì¤‘ê°„ í”¼ì²˜ ì €ì¥ ë° ì—°ì‚°ì„ ì¤„ì˜€ìŠµë‹ˆë‹¤.
head:
  # [from, repeats, module, args]
  # (10) SPPF ì¶œë ¥(ì±„ë„ 320)ì„ P4 í•´ìƒë„ë¡œ ì—…ìƒ˜í”Œí•˜ì—¬ í™œìš©
  - [-1, 1, nn.Upsample, [None, 2, "nearest"]]         # 10: Upsample SPPF output
  # (11) ë°±ë³¸ layer 6 (P4, ì±„ë„ 160)ì™€ concat
  - [[10, 6], 1, Concat, [1]]                             # 11: Concat with backbone layer 6
  # (12) concatëœ í”¼ì²˜ë¥¼ ì²˜ë¦¬í•˜ëŠ” C3k2 ëª¨ë“ˆ: ì±„ë„ 160
  - [-1, 1, C3k2, [160, False]]                            # 12: Process concatenated P4 features
  
  # (13) P4 í”¼ì²˜ë¥¼ P3 í•´ìƒë„ë¡œ ì—…ìƒ˜í”Œ
  - [-1, 1, nn.Upsample, [None, 2, "nearest"]]            # 13: Upsample to P3 resolution
  # (14) ë°±ë³¸ layer 4 (P3, ì±„ë„ 160 â†’ ì‹¤ì œ backbone layer 4ëŠ” 160)ì™€ concat
  - [[13, 4], 1, Concat, [1]]                             # 14: Concat with backbone layer 4
  # (15) concatëœ í”¼ì²˜ ì²˜ë¦¬: ì±„ë„ 96 (ë” ì‘ì€ ì±„ë„ ìˆ˜ë¡œ ë©”ëª¨ë¦¬ ì ˆê°)
  - [-1, 1, C3k2, [96, False]]                             # 15: Process concatenated P3 features
  
  # (16) P3 branchë¥¼ downsampleí•˜ì—¬ P4 í•´ìƒë„ë¡œ ë§ì¶¤ (ì±„ë„ 96)
  - [-1, 1, Conv, [96, 3, 2]]                             # 16: Downsample P3 branch to P4 resolution
  # (17) ë‹¤ìš´ìƒ˜í”Œëœ P3 í”¼ì²˜ì™€ P4 branch (layer 12, ì±„ë„ 160)ë¥¼ concat
  - [[16, 12], 1, Concat, [1]]                            # 17: Concat downsampled P3 branch with P4 branch
  # (18) ìµœì¢… í”¼ì²˜ ì²˜ë¦¬: ì±„ë„ 160
  - [-1, 1, C3k2, [160, True]]                             # 18: Final feature processing
  # (19) ê²€ì¶œ ë ˆì´ì–´: ë‹¨ì¼ ìŠ¤ì¼€ì¼ì—ì„œ 2ê°œ í´ë˜ìŠ¤ ê²€
  - [-1, 2, C3k2, [512, False]] # 19 (P4/16-medium)ì¶œ
  - [[18], 1, Detect, [nc]]                               # 19: Detect layer
